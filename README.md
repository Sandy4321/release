# microscopes-release

Linux: [![Build Status](https://travis-ci.org/datamicroscopes/release.svg?branch=master)](https://travis-ci.org/datamicroscopes/release) OS X: [![Build Status](https://travis-ci.org/datamicroscopes/release.svg?branch=osx)](https://travis-ci.org/datamicroscopes/release)

Tools for building conda releases of datamicroscopes on both Linux and OS X.

Please install dependencies in `requirements.txt`.

## travis.yml

We deploy to Anaconda.org by using Travis CI as a build server.

This is somewhat hacky and requires modifying `.travis.yml` to specify the Anaconda channel we want to use and what OS to build for.

__`.travis.yml` in this repository is automatically generated by the fabric commands below. Do not modify it manually.__

If you need to modify the travis-ci configuration, modify `travis.yml` (no leading period) instead. Fabric generates `.travis.yml` from this `travis.yml` file.

## Building a new conda release

Committers can build a new conda release by simplying updating the git submodule pointers and pushing to this repo. Travis CI takes care of the rest. When checkout out the repository for the first time, initialize the submodules with the following commands:

    $ git submodule init

Once the submodules are initialized, we can update the submodules to the master version on Github with:

    $ fab update

To push a new OS X build to Anaconda.org, use

    $ fab release_osx

To push a new Linux build to Anaconda.org, use

    $ fab release_linux

By default, we build to the [main channel on Anaconda.org](http://docs.anaconda.org/#Channels). You can build to another channel (e.g. the dev channel) by running a command like:

    $ fab release_osx:dev

You can specify the channel you want to install from with a command like:

    $ conda install -c datamicroscopes/channel/dev microscopes-common

If `conda-install` cannot find a package in the channel, it will also look it the channels specified in your `.condarc` file. You can override this with the `--override-channels` flag.